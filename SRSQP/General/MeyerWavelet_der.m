function [phi_dash,psi_dash] = MeyerWavelet_der(t)
%% Meyer wavelet (psi) and scale (phi) as in Valenzuela and Oliviera


if(t==0 || t==3/4 || t==-3/4) %0,3/4,-3/5
    %phi = 2/3 + 4/(3*pi); %orig form in paper for t=0
    %phi = (a1*cos(a1*t) + a2*cos(a3*t) - a2*a3*t*sin(a3*t))/ ...
    %    (a4-3*a5*t^2); % via L'Hop
    
    
        num=(32*pi*t*((4*cos((4*pi*t)/3))/3 + (2*pi*cos((2*pi*t)/3))/3 ...
            - (16*pi*t*sin((4*pi*t)/3))/9))/3 - (pi - ...
            (16*pi*t^2)/3)*((32*pi*sin((4*pi*t)/3))/9 + ...
            (4*pi^2*sin((2*pi*t)/3))/9 + ...
            (64*pi^2*t*cos((4*pi*t)/3))/27);
        den = (pi - (16*pi*t^2)/3)*(2*pi - (32*pi*t^2)/3);
        phi_dash = num/den;
    
    
    
else %if not those NaN cases
    %phi = (sin((2*pi/3)*t) + (4*t/3)*cos(4*pi*t/3))/ ...
    %(pi*t-(16*pi*t^3)/9);
    
    
        phi_dash = ((4*cos((4*pi*t)/3))/3 + (2*pi*cos((2*pi*t)/3))/3 ...
            - (16*pi*t*sin((4*pi*t)/3))/9)/(pi*t - (16*pi*t^3)/9) - ...
            ((pi - (16*pi*t^2)/3)*(sin((2*pi*t)/3) + ...
            (4*t*cos((4*pi*t)/3))/3))/(pi*t - (16*pi*t^3)/9)^2;
    
end

%evalue psi_1
z=t-0.5;

%L'HopyBoy's rule at the points of 0/0 for psi_1
if(z==0 || z== 3/4 || z==-3/4)
    %psi_1_num = -c1*c2*z*sin(c2*z)+c1*cos(c2*z)-c4*c3*cos(c4*z);
    %psi_1_den = 1-3*c5*z^2;
    %psi_1 = psi_1_num/psi_1_den;
    
    
        psi_1_dash = (((16*(t - 1/2)^2)/3 - 1)* ...
            ((1911387046407553*pi*sin((2*pi*(t - 1/2))/3))/ ...
            3377699720527872 - ...
            (1911387046407553*pi^2*sin((4*pi*(t - 1/2))/3))/ ...
            3377699720527872 + (4*pi^2*cos((2*pi*(t - 1/2))/3) ...
            *((1911387046407553*t)/4503599627370496 ...
            - 1911387046407553/9007199254740992))/9) - ...
            ((1911387046407553*pi*sin((2*pi*(t - 1/2))/3))/ ...
            3377699720527872 - (1911387046407553*pi^2* ...
            sin((4*pi*(t - 1/2))/3))/3377699720527872 + ...
            (4*pi^2*cos((2*pi*(t - 1/2))/3)*((1911387046407553*t)...
            /4503599627370496 - 1911387046407553/9007199254740992))...
            /9)*((1911387046407553*pi*cos((4*pi*(t - 1/2))/3))/...
            4503599627370496 - (1911387046407553* ...
            cos((2*pi*(t - 1/2))/3))/4503599627370496 + ...
            (2*pi*sin((2*pi*(t - 1/2))/3)*((1911387046407553*t)/ ...
            4503599627370496 - 1911387046407553/9007199254740992)) ...
            /3))/(((16*(t - 1/2)^2)/3 - 1)*((32*(t - 1/2)^2)/3 - 2));
    
    
else
    
    psi_1_dash = ((1911387046407553*pi*cos((4*pi*(t - 1/2))/3))/4503599627370496 - (1911387046407553*cos((2*pi*(t - 1/2))/3))/4503599627370496 + (2*pi*sin((2*pi*(t - 1/2))/3)*((1911387046407553*t)/4503599627370496 - 1911387046407553/9007199254740992))/3)/((16*(t - 1/2)^3)/9 - t + 1/2) - (((5734161139222659*sin((4*pi*(t - 1/2))/3))/18014398509481984 - cos((2*pi*(t - 1/2))/3)*((1911387046407553*t)/4503599627370496 - 1911387046407553/9007199254740992))*((16*(t - 1/2)^2)/3 - 1))/((16*(t - 1/2)^3)/9 - t + 1/2)^2;
    
end
% for psi_2 now
if(z==0 || z==3/8 || z==-3/8)
    %psi_2_num = -k1*k2*z*sin(k2*z)+k1*cos(k2*z)+k4*k3*cos(k4*z);
    %psi_2_den = 1-3*k5*z^2;
    %psi_2 = psi_2_num/psi_2_den;
    
        psi_2_dash = (((64*(t - 1/2)^2)/3 - 1)*((1911387046407553*pi^2*sin((4*pi*(t - 1/2))/3))/3377699720527872 + (1911387046407553*pi*sin((8*pi*(t - 1/2))/3))/422212465065984 + (64*pi^2*cos((8*pi*(t - 1/2))/3)*((1911387046407553*t)/2251799813685248 - 1911387046407553/4503599627370496))/9) + ((128*t)/3 - 64/3)*((1911387046407553*cos((8*pi*(t - 1/2))/3))/2251799813685248 + (1911387046407553*pi*cos((4*pi*(t - 1/2))/3))/4503599627370496 - (8*pi*sin((8*pi*(t - 1/2))/3)*((1911387046407553*t)/2251799813685248 - 1911387046407553/4503599627370496))/3))/(((16*(t - 1/2)^2)/3 - 1)*((32*(t - 1/2)^2)/3 - 2));
    
    
else
    
        
        psi_2_dash = (((5734161139222659*sin((4*pi*(t - 1/2))/3))/18014398509481984 + cos((8*pi*(t - 1/2))/3)*((1911387046407553*t)/2251799813685248 - 1911387046407553/4503599627370496))*((64*(t - 1/2)^2)/3 - 1))/((64*(t - 1/2)^3)/9 - t + 1/2)^2 - ((1911387046407553*cos((8*pi*(t - 1/2))/3))/2251799813685248 + (1911387046407553*pi*cos((4*pi*(t - 1/2))/3))/4503599627370496 - (8*pi*sin((8*pi*(t - 1/2))/3)*((1911387046407553*t)/2251799813685248 - 1911387046407553/4503599627370496))/3)/((64*(t - 1/2)^3)/9 - t + 1/2);
    
    
end

psi_dash = psi_1_dash + psi_2_dash;

